import React from 'react';
import { View, Text, StyleSheet, TouchableOpacity, SafeAreaView, ScrollView } from 'react-native';
import { MaterialCommunityIcons } from '@expo/vector-icons';
import { useFood } from './FoodContext';

function BreakfastScreen() {
  const { breakfastEntries, removeBreakfastFood } = useFood();

  const handleRemoveFood = (index) => {
    removeBreakfastFood(index);
  };

  return (
    <SafeAreaView style={styles.container}>
      <ScrollView>
        <Text style={styles.tableHeader}>Breakfast Foods</Text>
        {breakfastEntries.length > 0 ? (
          <View>
            <View style={[styles.tableRow, styles.tableHeaderRow]}>
              <Text style={[styles.tableCell, styles.tableHeaderCell, { flex: 1.5, textAlign: 'left' }]}>Food</Text>
              <Text style={[styles.tableCell, styles.tableHeaderCell]}>Items</Text>
              <Text style={[styles.tableCell, styles.tableHeaderCell]}>Weight</Text>
              <Text style={[styles.tableCell, styles.tableHeaderCell]}>Calories</Text>
              <Text style={[styles.tableCell, styles.tableHeaderCell]}>Protein</Text>
              <Text style={[styles.tableCell, styles.tableHeaderCell]}>Carbs</Text>
              <Text style={[styles.tableCell, styles.tableHeaderCell]}>Fat</Text>
            </View>
            {breakfastEntries.map((food, index) => (
              <View key={index} style={styles.tableRow}>
                <Text style={[styles.tableCell, { flex: 1.5, textAlign: 'left' }]}>{food.name}</Text>
                <Text style={styles.tableCell}>{food.quantity}</Text>
                <Text style={styles.tableCell}>{food.weight ? `${food.weight} g` : '-'}</Text>
                <Text style={styles.tableCell}>{food.calories || '-'}</Text>
                <Text style={styles.tableCell}>{food.protein || '-'}</Text>
                <Text style={styles.tableCell}>{food.carbs || '-'}</Text>
                <Text style={styles.tableCell}>{food.fat || '-'}</Text>
                <TouchableOpacity onPress={() => handleRemoveFood(index)} style={styles.deleteButton}>
                  <MaterialCommunityIcons name="minus-circle" size={20} color="#D32F2F" />
                </TouchableOpacity>
              </View>
            ))}
          </View>
        ) : (
          <Text style={styles.noDataText}>No foods added yet.</Text>
        )}
      </ScrollView>
    </SafeAreaView>
  );
}

const styles = StyleSheet.create({
  container: { flex: 1, padding: 16, backgroundColor: '#fff' },
  tableHeader: { fontSize: 18, fontWeight: 'bold', marginBottom: 12 },
  tableRow: { 
    flexDirection: 'row', 
    justifyContent: 'space-between', 
    paddingVertical: 8, 
    borderBottomWidth: 1, 
    borderBottomColor: '#eee', 
    alignItems: 'center' 
  },
  tableHeaderRow: { borderBottomWidth: 2, borderBottomColor: '#ccc' },
  tableCell: { flex: 1, textAlign: 'center', fontSize: 14, color: '#333' },
  tableHeaderCell: { fontWeight: 'bold', color: '#555' },
  noDataText: { textAlign: 'center', marginTop: 8, color: '#888' },
  deleteButton: { justifyContent: 'center', alignItems: 'center', flex: 0.2 },
});

export default BreakfastScreen;